<div class="list-container">
  <h2>ðŸ“‹ Tus contadores</h2>

  <div class="table-container">
    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z3">

      <!-- ID -->
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
        <td mat-cell *matCellDef="let element">
          <span class="id-text">{{ element.id }} </span>
          <button class="copy-btn copya-btn" (click)="copyId(element.id)" title="Copiar ID">
            <i class="fa fa-copy"></i>
          </button>
          <!-- ðŸ“‹ Copiar URL actual -->
          <button
            type="button"
            class="copy-btn copya-btn"
            title="Copiar URL"
            (click)="copyCurrentUrl(element.id)"
          >
            <i class="fa fa-link"></i> <!-- o lucide: <LinkIcon /> -->
          </button>
        </td>
      </ng-container>

      <!-- Creado -->
      <ng-container matColumnDef="createdAt">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Creado</th>
        <td mat-cell *matCellDef="let element">{{ formatDate(element.createdAt) }}</td>
      </ng-container>

      <!-- Modificado -->
      <ng-container matColumnDef="updatedAt">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Ãšltima ModificaciÃ³n</th>
        <td mat-cell *matCellDef="let element">{{ formatDate(element.updatedAt) }}</td>
      </ng-container>

      <!-- Local -->
      <ng-container matColumnDef="leftName">
        <th mat-header-cell *matHeaderCellDef>Local (Set Activo)</th>
        <td mat-cell *matCellDef="let element">
          <strong>{{ element.leftName }} - {{ element.leftValue }} </strong>
        </td>
      </ng-container>

      <!-- Visitante -->
      <ng-container matColumnDef="rightName">
        <th mat-header-cell *matHeaderCellDef>Visitante (Set Activo)</th>
        <td mat-cell *matCellDef="let element">
          <strong>{{ element.rightName }} - {{ element.rightValue }} </strong> 
        </td>
      </ng-container>

      <!-- Sets -->
      <ng-container matColumnDef="sets">
        <th mat-header-cell *matHeaderCellDef>Sets</th>
        <td mat-cell *matCellDef="let element">{{ element.gamesCount || 0 }}</td>
      </ng-container>

      <!-- Acciones -->
      <!-- Acciones -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Acciones</th>

        <td mat-cell *matCellDef="let element">
          <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="MÃ¡s acciones">
            <mat-icon>more_vert</mat-icon>
          </button>

          <mat-menu #menu="matMenu">
            <button mat-menu-item *ngFor="let opt of actionOptions" (click)="executeAction(opt, element)">
              <mat-icon>{{ opt.icon }}</mat-icon>
              <span>{{ opt.label }}</span>
            </button>
          </mat-menu>
        </td>
      </ng-container>

      <!-- Header y body -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>

    <mat-paginator
      [pageSizeOptions]="[5, 10, 20]"
      showFirstLastButtons
      [pageSize]="10"
    ></mat-paginator>
  </div>


  

  <div class="table-container authorized" *ngIf="authorizedDataSource?.data!.length > 0">
    <h2>âœ” Contadores autorizados</h2>
    <table mat-table [dataSource]="authorizedDataSource" matSort class="mat-elevation-z3">

      <!-- Reutilizamos las mismas columnas excepto Acciones -->
      <ng-container *ngFor="let col of authorizedColumns" [matColumnDef]="col">
        <th mat-header-cell *matHeaderCellDef>{{ col }}</th>
        <td mat-cell *matCellDef="let element">{{ element[col] }}</td>
      </ng-container>

      <!-- Solo acciÃ³n cargar -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Acciones</th>
        <td mat-cell *matCellDef="let element">
          <button mat-menu-item (click)="edit(element)">
            <mat-icon>edit</mat-icon>
            <span>Cargar</span>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="authorizedDisplayed"></tr>
      <tr mat-row *matRowDef="let row; columns: authorizedDisplayed"></tr>
    </table>

    <mat-paginator [pageSize]="5"></mat-paginator>
  </div>
  
  <!-- Modal de confirmaciÃ³n -->
  <div class="modal-overlay" *ngIf="showDeleteConfirm" (click)="cancelDelete()">
    <div class="modal" (click)="$event.stopPropagation()">
      <h3>Â¿Seguro que quieres eliminar el marcador "{{ rowDelete?.leftName }} vs {{ rowDelete?.rightName }}"?</h3>
      <p>Â¿Seguro que quieres eliminar este set?</p>
      <div class="modal-actions">
        <button class="cancel" (click)="cancelDelete()">Cancelar</button>
        <button class="confirm" (click)="confirmDelete()">Eliminar</button>
      </div>
    </div>
  </div>

</div>
